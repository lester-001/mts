<?xml version="1.0" encoding="UTF-8"?>
<!-- Related XMLSchema file: conf/schemas/scenario.xsd -->
<scenario>
    <function name="AuthResp">
        <input>
            <parameter name="[function:res_param]" />
        </input>
    
        <do>    
            <parameter name="[Auth_msg]" operation="set">
            <![CDATA[
            <L3MessageWrapper>
                <ExtendedProtocolDiscriminator>
                    <ExtendedProtocolDiscriminator>
                        <ExtendedProtocolDiscriminator>A5gsMobilityManagementMessages</ExtendedProtocolDiscriminator>
                    </ExtendedProtocolDiscriminator>
                </ExtendedProtocolDiscriminator>
                <SpareHalfOctet>
                    <SpareHalfOctet/></SpareHalfOctet>
                <SecurityHeaderType>
                    <SecurityHeaderType>
                        <SecurityHeaderType>IntegrityProtected</SecurityHeaderType>
                        <IntegrityProtected>
                            <MessageAuthenticationCode>
                                <MessageAuthenticationCode>
                                    <Length>32</Length>
                                    <MessageAuthenticationCodeValue>69676F25</MessageAuthenticationCodeValue>
                                </MessageAuthenticationCode>
                            </MessageAuthenticationCode>
                            <SequenceNumber>
                                <SequenceNumber>
                                    <SequenceNumberValue>5</SequenceNumberValue>
                                </SequenceNumber>
                            </SequenceNumber>
                        </IntegrityProtected>
                    </SecurityHeaderType>
                </SecurityHeaderType>
                <PlainNas5GsMessage>
                    <ExtendedProtocolDiscriminator>
                        <ExtendedProtocolDiscriminator>
                            <ExtendedProtocolDiscriminator>A5gsMobilityManagementMessages</ExtendedProtocolDiscriminator>
                        </ExtendedProtocolDiscriminator>
                    </ExtendedProtocolDiscriminator>
                    <SpareHalfOctet>
                        <SpareHalfOctet/></SpareHalfOctet>
                    <SecurityHeaderType>
                        <SecurityHeaderType>
                            <SecurityHeaderType>Plain5gsNasMessageNotSecurityProtected</SecurityHeaderType>
                            <Plain5gsNasMessageNotSecurityProtected>
                                <MessageType>
                                    <MessageType>
                                        <MessageType>AuthenticationResponse</MessageType>
                                        <AuthenticationResponse>
                                            <AuthenticationResponseParameter>
                                                <IEI>2D</IEI>
                                                <AuthenticationResponseParameter>
                                                    <Length>16</Length>
                                                    <Res>[res_param]</Res>
                                                </AuthenticationResponseParameter>
                                            </AuthenticationResponseParameter>
                                        </AuthenticationResponse>
                                    </MessageType>
                                </MessageType>
                            </Plain5gsNasMessageNotSecurityProtected>
                        </SecurityHeaderType>
                    </SecurityHeaderType>
                </PlainNas5GsMessage>
            </L3MessageWrapper>
            ]]>
            </parameter>

            <parameter name="[AuthenticationResponseParameter]" operation="string.xpath" value="[Auth_msg]" value2="//AuthenticationResponseParameter" />
            
            <parameter name="[Auth_msgd]" operation="protocol.setFromNAS" value="[Auth_msg]" value2="encode"/>

        </do>
      
        <output>
            <parameter name="[function:Auth_msgd]" />
        </output>
    </function>
</scenario>