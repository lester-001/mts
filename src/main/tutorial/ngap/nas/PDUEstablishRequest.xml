<?xml version="1.0" encoding="UTF-8"?>
<!-- Related XMLSchema file: conf/schemas/scenario.xsd -->
<scenario>
    <function name="PduEstablishRequest">
        <input>
        </input>
    
        <do>    
            <parameter name="[est_request]" operation="set">
            <![CDATA[
<L3MessageWrapper>
    <ExtendedProtocolDiscriminator>
        <ExtendedProtocolDiscriminator>
            <ExtendedProtocolDiscriminator>A5gsMobilityManagementMessages</ExtendedProtocolDiscriminator>
        </ExtendedProtocolDiscriminator>
    </ExtendedProtocolDiscriminator>
    <SpareHalfOctet>
        <SpareHalfOctet/></SpareHalfOctet>
    <SecurityHeaderType>
        <SecurityHeaderType>
            <SecurityHeaderType>IntegrityProtectedAndCiphered</SecurityHeaderType>
            <IntegrityProtectedAndCiphered>
                <MessageAuthenticationCode>
                    <MessageAuthenticationCode>
                        <Length>32</Length>
                        <MessageAuthenticationCodeValue>2E31235E</MessageAuthenticationCodeValue>
                    </MessageAuthenticationCode>
                </MessageAuthenticationCode>
                <SequenceNumber>
                    <SequenceNumber>
                        <SequenceNumberValue>2</SequenceNumberValue>
                    </SequenceNumber>
                </SequenceNumber>
            </IntegrityProtectedAndCiphered>
        </SecurityHeaderType>
    </SecurityHeaderType>
    <PlainNas5GsMessage>
        <ExtendedProtocolDiscriminator>
            <ExtendedProtocolDiscriminator>
                <ExtendedProtocolDiscriminator>A5gsMobilityManagementMessages</ExtendedProtocolDiscriminator>
            </ExtendedProtocolDiscriminator>
        </ExtendedProtocolDiscriminator>
        <SpareHalfOctet>
            <SpareHalfOctet/></SpareHalfOctet>
        <SecurityHeaderType>
            <SecurityHeaderType>
                <SecurityHeaderType>Plain5gsNasMessageNotSecurityProtected</SecurityHeaderType>
                <Plain5gsNasMessageNotSecurityProtected>
                    <MessageType>
                        <MessageType>
                            <MessageType>UlNasTransport</MessageType>
                            <UlNasTransport>
                                <SpareHalfOctet>
                                    <SpareHalfOctet/></SpareHalfOctet>
                                <PayloadContainerType>
                                    <PayloadContainerType>
                                        <PayloadContainerType>N1SmInformation</PayloadContainerType>
                                    </PayloadContainerType>
                                </PayloadContainerType>
                                <PayloadContainer>
                                    <Length>21</Length>
                                    <PayloadContainer>
                                        <ExtendedProtocolDiscriminator>A5gsSessionManagementMessages</ExtendedProtocolDiscriminator>
                                        <PduSessionIdentity>PduSessionIdentityValue1</PduSessionIdentity>
                                        <Pti>1</Pti>
                                        <MessageType>PduSessionEstablishmentRequest</MessageType>
                                        <PduSessionEstablishmentRequest>
                                            <IntegrityProtectionMaximumDataRate>
                                                <IntegrityProtectionMaximumDataRate>
                                                    <MaximumDataRatePerUeForUserplaneIntegrityProtectionForUplink>FF</MaximumDataRatePerUeForUserplaneIntegrityProtectionForUplink>
                                                    <MaximumDataRatePerUeForUserplaneIntegrityProtectionForDownlink>FF</MaximumDataRatePerUeForUserplaneIntegrityProtectionForDownlink>
                                                </IntegrityProtectionMaximumDataRate>
                                            </IntegrityProtectionMaximumDataRate>
                                            <PduSessionType>
                                                <IEI>9</IEI>
                                                <PduSessionType>
                                                    <PduSessionTypeValue>Ipv4</PduSessionTypeValue>
                                                </PduSessionType>
                                            </PduSessionType>
                                            <SscMode>
                                                <IEI>A</IEI>
                                                <SscMode>
                                                    <SscModeValue>SscMode1</SscModeValue>
                                                </SscMode>
                                            </SscMode>
                                            <A5gsmCapability>
                                                <IEI>28</IEI>
                                                <Length>1</Length>
                                                <A5gsmCapability>
                                                    <MultihomedIpv6PduSession>MultihomedIpv6PduSessionNotSupported</MultihomedIpv6PduSession>
                                                    <Rqos>ReflectiveQosNotSupported</Rqos>
                                                </A5gsmCapability>
                                            </A5gsmCapability>
                                            <ExtendedProtocolConfigurationOptions>
                                                <IEI>7B</IEI>
                                                <ExtendedProtocolConfigurationOptions>
                                                    <Length>6</Length>
                                                    <Extension>1</Extension>
                                                    <ConfigurationProtocol>0</ConfigurationProtocol>
                                                    <ExtendedProtocolConfigurationOption1>
                                                        <ProtocolOrContainerID>10</ProtocolOrContainerID>
                                                        <IPAddressAllocViaNAS>
                                                            <Length>0</Length>
                                                        </IPAddressAllocViaNAS>
                                                    </ExtendedProtocolConfigurationOption1>
                                                    <ExtendedProtocolConfigurationOption2>
                                                        <ProtocolOrContainerID>13</ProtocolOrContainerID>
                                                        <DNSServerIPv4Addr>
                                                            <Length>0</Length>
                                                        </DNSServerIPv4Addr>
                                                    </ExtendedProtocolConfigurationOption2>
                                                </ExtendedProtocolConfigurationOptions>
                                            </ExtendedProtocolConfigurationOptions>
                                        </PduSessionEstablishmentRequest>
                                    </PayloadContainer>
                                </PayloadContainer>
                                <PduSessionId>
                                    <IEI>12</IEI>
                                    <PduSessionIdentity2>
                                        <PduSessionIdentity2Value>PduSessionIdentityValue1</PduSessionIdentity2Value>
                                    </PduSessionIdentity2>
                                </PduSessionId>
                                <RequestType>
                                    <IEI>8</IEI>
                                    <RequestType>
                                        <RequestTypeValue>InitialRequest</RequestTypeValue>
                                    </RequestType>
                                </RequestType>
                                <Snssai>
                                    <IEI>22</IEI>
                                    <Snssai>
                                        <LengthOfSnssaiContents>SstAndSd</LengthOfSnssaiContents>
                                        <Sst>01</Sst>
                                        <Sd>000001</Sd>
                                    </Snssai>
                                </Snssai>
                                <Dnn>
                                    <IEI>25</IEI>
                                    <Dnn>
                                        <Length>6</Length>
                                        <DnnValue>05636D6E6574</DnnValue>
                                    </Dnn>
                                </Dnn>
                            </UlNasTransport>
                        </MessageType>
                    </MessageType>
                </Plain5gsNasMessageNotSecurityProtected>
            </SecurityHeaderType>
        </SecurityHeaderType>
    </PlainNas5GsMessage>
</L3MessageWrapper>
            ]]>
            </parameter>
            
            <parameter name="[est_request_enc]" operation="protocol.setFromNAS" value="[est_request]" value2="encode"/>

        </do>
      
        <output>
            <parameter name="[function:est_request_enc]" />
        </output>
    </function>
</scenario>