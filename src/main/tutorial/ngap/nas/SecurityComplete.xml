<?xml version="1.0" encoding="UTF-8"?>
<!-- Related XMLSchema file: conf/schemas/scenario.xsd -->
<scenario>
    <function name="securityComp">
        <input>
        </input>
    
        <do>    
            <parameter name="[sec_msg]" operation="set">
            <![CDATA[
<L3MessageWrapper>
    <ExtendedProtocolDiscriminator>
        <ExtendedProtocolDiscriminator>
            <ExtendedProtocolDiscriminator>A5gsMobilityManagementMessages</ExtendedProtocolDiscriminator>
        </ExtendedProtocolDiscriminator>
    </ExtendedProtocolDiscriminator>
    <SpareHalfOctet>
        <SpareHalfOctet/></SpareHalfOctet>
    <SecurityHeaderType>
        <SecurityHeaderType>
            <SecurityHeaderType>IntegrityProtectedAndCipheredWithNew5gNasSecurityContext</SecurityHeaderType>
            <IntegrityProtectedAndCipheredWithNew5gNasSecurityContext>
                <MessageAuthenticationCode>
                    <MessageAuthenticationCode>
                        <Length>32</Length>
                        <MessageAuthenticationCodeValue>B0C7F761</MessageAuthenticationCodeValue>
                    </MessageAuthenticationCode>
                </MessageAuthenticationCode>
                <SequenceNumber>
                    <SequenceNumber>
                        <SequenceNumberValue>0</SequenceNumberValue>
                    </SequenceNumber>
                </SequenceNumber>
            </IntegrityProtectedAndCipheredWithNew5gNasSecurityContext>
        </SecurityHeaderType>
    </SecurityHeaderType>
    <PlainNas5GsMessage>
        <ExtendedProtocolDiscriminator>
            <ExtendedProtocolDiscriminator>
                <ExtendedProtocolDiscriminator>A5gsMobilityManagementMessages</ExtendedProtocolDiscriminator>
            </ExtendedProtocolDiscriminator>
        </ExtendedProtocolDiscriminator>
        <SpareHalfOctet>
            <SpareHalfOctet/></SpareHalfOctet>
        <SecurityHeaderType>
            <SecurityHeaderType>
                <SecurityHeaderType>Plain5gsNasMessageNotSecurityProtected</SecurityHeaderType>
                <Plain5gsNasMessageNotSecurityProtected>
                    <MessageType>
                        <MessageType>
                            <MessageType>SecurityModeComplete</MessageType>
                            <SecurityModeComplete>
                                <Imeisv>
                                    <IEI>77</IEI>
                                    <Length>9</Length>
                                    <A5gsMobileIdentity>
                                        <Digit>4</Digit>
                                        <OddEvenIndication>EvenNumberOfIdentityDigits</OddEvenIndication>
                                        <TypeOfIdentity>Imeisv</TypeOfIdentity>
                                        <IdentityDigit>73806121856151F1</IdentityDigit>
                                    </A5gsMobileIdentity>
                                </Imeisv>
                                <NasMessageContainer>
                                    <IEI>71</IEI>
                                    <Length>38</Length>
                                    <NasMessageContainer>
                                        <ExtendedProtocolDiscriminator>A5gsMobilityManagementMessages</ExtendedProtocolDiscriminator>
                                        <SecurityHeaderType>Plain5gsNasMessageNotSecurityProtected</SecurityHeaderType>
                                        <Plain5gsNasMessageNotSecurityProtected>
                                            <MessageType>
                                                <MessageType>
                                                    <MessageType>RegistrationRequest</MessageType>
                                                    <RegistrationRequest>
                                                        <Ngksi>
                                                            <NasKeySetIdentifier>
                                                                <Tsc>NativeSecurityContext(forKsiamf)</Tsc>
                                                                <NasKeySetIdentifierValue>7</NasKeySetIdentifierValue>
                                                            </NasKeySetIdentifier>
                                                        </Ngksi>
                                                        <A5gsRegistrationType>
                                                            <A5gsRegistrationType>
                                                                <For>FollowonRequestPending</For>
                                                                <A5gsRegistrationTypeValue>InitialRegistration</A5gsRegistrationTypeValue>
                                                            </A5gsRegistrationType>
                                                        </A5gsRegistrationType>
                                                        <A5gsMobileIdentity>
                                                            <Length>13</Length>
                                                            <A5gsMobileIdentity>
                                                                <Digit>0</Digit>
                                                                <OddEvenIndication>EvenNumberOfIdentityDigits</OddEvenIndication>
                                                                <TypeOfIdentity>Suci</TypeOfIdentity>
                                                                <MccDigit2>0</MccDigit2>
                                                                <MccDigit1>0</MccDigit1>
                                                                <MncDigit3>15</MncDigit3>
                                                                <MccDigit3>1</MccDigit3>
                                                                <MncDigit2>1</MncDigit2>
                                                                <MncDigit1>0</MncDigit1>
                                                                <RoutingIndicatorDigit2>0</RoutingIndicatorDigit2>
                                                                <RoutingIndicatorDigit1>0</RoutingIndicatorDigit1>
                                                                <RoutingIndicatorDigit4>0</RoutingIndicatorDigit4>
                                                                <RoutingIndicatorDigit3>0</RoutingIndicatorDigit3>
                                                                <ProtectionSchemeId>0</ProtectionSchemeId>
                                                                <HomeNetworkPublicKeyIdentifier>NullScheme</HomeNetworkPublicKeyIdentifier>
                                                                <SchemeOutput>0000000010</SchemeOutput>
                                                            </A5gsMobileIdentity>
                                                        </A5gsMobileIdentity>
                                                        <A5gmmCapability>
                                                            <IEI>10</IEI>
                                                            <Length>1</Length>
                                                            <A5gmmCapability>
                                                                <Lpp>LppInN1ModeNotSupported</Lpp>
                                                                <HoAttach>AttachRequestMessageContainingPdnConnectivityRequestMessageWithRequestTypeSetTo"handover"Or"handoverOfEmergencyBearerServices"ToTransferPduSessionFromN1ModeToS1ModeNotSupported</HoAttach>
                                                                <S1Mode>S1ModeNotSupported</S1Mode>
                                                            </A5gmmCapability>
                                                        </A5gmmCapability>
                                                        <UeSecurityCapability>
                                                            <IEI>2E</IEI>
                                                            <Length>4</Length>
                                                            <UeSecurityCapability>
                                                                <A5gsEncryptionAlgorithm5gea0Supported>A5gsEncryptionAlgorithm5gea0Supported</A5gsEncryptionAlgorithm5gea0Supported>
                                                                <A5gsEncryptionAlgorithm1285gea1Supported>A5gsEncryptionAlgorithm1285gea1Supported</A5gsEncryptionAlgorithm1285gea1Supported>
                                                                <A5gsEncryptionAlgorithm1285gea2Supported>A5gsEncryptionAlgorithm1285gea2Supported</A5gsEncryptionAlgorithm1285gea2Supported>
                                                                <A5gsEncryptionAlgorithm1285gea3Supported>A5gsEncryptionAlgorithm1285gea3Supported</A5gsEncryptionAlgorithm1285gea3Supported>
                                                                <A5gsEncryptionAlgorithm1285gea4Supported>A5gsEncryptionAlgorithm1285gea4NotSupported</A5gsEncryptionAlgorithm1285gea4Supported>
                                                                <A5gsEncryptionAlgorithm1285gea5Supported>A5gsEncryptionAlgorithm1285gea5NotSupported</A5gsEncryptionAlgorithm1285gea5Supported>
                                                                <A5gsEncryptionAlgorithm1285gea6Supported>A5gsEncryptionAlgorithm1285gea6NotSupported</A5gsEncryptionAlgorithm1285gea6Supported>
                                                                <A5gsEncryptionAlgorithm1285gea7Supported>A5gsEncryptionAlgorithm1285gea7NotSupported</A5gsEncryptionAlgorithm1285gea7Supported>
                                                                <A5gsIntegrityAlgorithm5gia0Supported>A5gsIntegrityAlgorithm5gia0Supported</A5gsIntegrityAlgorithm5gia0Supported>
                                                                <A5gsEncryptionAlgorithm1285gia1Supported>A5gsEncryptionAlgorithm1285gia1Supported</A5gsEncryptionAlgorithm1285gia1Supported>
                                                                <A5gsEncryptionAlgorithm1285gia2Supported>A5gsEncryptionAlgorithm1285gia2Supported</A5gsEncryptionAlgorithm1285gia2Supported>
                                                                <A5gsEncryptionAlgorithm1285gia3Supported>A5gsEncryptionAlgorithm1285gia3Supported</A5gsEncryptionAlgorithm1285gia3Supported>
                                                                <A5gsEncryptionAlgorithm1285gia4Supported>A5gsEncryptionAlgorithm1285gia4NotSupported</A5gsEncryptionAlgorithm1285gia4Supported>
                                                                <A5gsEncryptionAlgorithm1285gia5Supported>A5gsEncryptionAlgorithm1285gia5NotSupported</A5gsEncryptionAlgorithm1285gia5Supported>
                                                                <A5gsEncryptionAlgorithm1285gia6Supported>A5gsEncryptionAlgorithm1285gia6NotSupported</A5gsEncryptionAlgorithm1285gia6Supported>
                                                                <A5gsEncryptionAlgorithm1285gia7Supported>A5gsEncryptionAlgorithm1285gia7NotSupported</A5gsEncryptionAlgorithm1285gia7Supported>
                                                                <EpsEncryptionAlgorithmEea0Supported>EpsEncryptionAlgorithmEea0Supported</EpsEncryptionAlgorithmEea0Supported>
                                                                <EpsEncryptionAlgorithmEea1Supported>EpsEncryptionAlgorithmEea1Supported</EpsEncryptionAlgorithmEea1Supported>
                                                                <EpsEncryptionAlgorithmEea2Supported>EpsEncryptionAlgorithmEea2Supported</EpsEncryptionAlgorithmEea2Supported>
                                                                <EpsEncryptionAlgorithmEea3Supported>EpsEncryptionAlgorithmEea3Supported</EpsEncryptionAlgorithmEea3Supported>
                                                                <EpsEncryptionAlgorithmEea4Supported>EpsEncryptionAlgorithmEea4NotSupported</EpsEncryptionAlgorithmEea4Supported>
                                                                <EpsEncryptionAlgorithmEea5Supported>EpsEncryptionAlgorithmEea5NotSupported</EpsEncryptionAlgorithmEea5Supported>
                                                                <EpsEncryptionAlgorithmEea6Supported>EpsEncryptionAlgorithmEea6NotSupported</EpsEncryptionAlgorithmEea6Supported>
                                                                <EpsEncryptionAlgorithmEea7Supported>EpsEncryptionAlgorithmEea7NotSupported</EpsEncryptionAlgorithmEea7Supported>
                                                                <EpsIntegrityAlgorithmEia0Supported>EpsIntegrityAlgorithmEia0Supported</EpsIntegrityAlgorithmEia0Supported>
                                                                <EpsIntegrityAlgorithmEia1Supported>EpsIntegrityAlgorithmEia1Supported</EpsIntegrityAlgorithmEia1Supported>
                                                                <EpsIntegrityAlgorithmEia2Supported>EpsIntegrityAlgorithmEia2Supported</EpsIntegrityAlgorithmEia2Supported>
                                                                <EpsIntegrityAlgorithmEia3Supported>EpsIntegrityAlgorithmEia3Supported</EpsIntegrityAlgorithmEia3Supported>
                                                                <EpsIntegrityAlgorithmEia4Supported>EpsIntegrityAlgorithmEia4NotSupported</EpsIntegrityAlgorithmEia4Supported>
                                                                <EpsIntegrityAlgorithmEia5Supported>EpsIntegrityAlgorithmEia5NotSupported</EpsIntegrityAlgorithmEia5Supported>
                                                                <EpsIntegrityAlgorithmEia6Supported>EpsIntegrityAlgorithmEia6NotSupported</EpsIntegrityAlgorithmEia6Supported>
                                                                <EpsIntegrityAlgorithmEia7Supported>EpsIntegrityAlgorithmEia7NotSupported</EpsIntegrityAlgorithmEia7Supported>
                                                            </UeSecurityCapability>
                                                        </UeSecurityCapability>
                                                        <RequestedNssai>
                                                            <IEI>2F</IEI>
                                                            <Nssai>
                                                                <LengthObject>5</LengthObject>
                                                                <SnssaiValue1>
                                                                    <LengthOfSNSSAIContents>4</LengthOfSNSSAIContents>
                                                                    <SST>01</SST>
                                                                    <SD>000001</SD>
                                                                </SnssaiValue1>
                                                            </Nssai>
                                                        </RequestedNssai>
                                                        <A5gsUpdateType>
                                                            <IEI>53</IEI>
                                                            <Length>1</Length>
                                                            <A5gsUpdateType>
                                                                <Ngranrcu>NgranRadioCapabilityUpdateNotNeeded</Ngranrcu>
                                                                <SmsRequested>SmsOverNasNotSupported</SmsRequested>
                                                            </A5gsUpdateType>
                                                        </A5gsUpdateType>
                                                    </RegistrationRequest>
                                                </MessageType>
                                            </MessageType>
                                        </Plain5gsNasMessageNotSecurityProtected>
                                    </NasMessageContainer>
                                </NasMessageContainer>
                            </SecurityModeComplete>
                        </MessageType>
                    </MessageType>
                </Plain5gsNasMessageNotSecurityProtected>
            </SecurityHeaderType>
        </SecurityHeaderType>
    </PlainNas5GsMessage>
</L3MessageWrapper>
            ]]>
            </parameter>

            
            <parameter name="[sec_msgd]" operation="protocol.setFromNAS" value="[sec_msg]" value2="encode"/>

        </do>
      
        <output>
            <parameter name="[function:sec_msgd]" />
        </output>
    </function>
</scenario>