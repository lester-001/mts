<?xml version="1.0" encoding="UTF-8"?>
<!-- Related XMLSchema file: conf/schemas/scenario.xsd -->
<scenario>
    <function name="handlePDUSessionResourceModify">
        <input>
        </input>
    
        <do>    
            <function file="ngap/PDUSessionResourceModifyResponse.xml" />
            <function file="nas/PDUSessionModifyComplete.xml" />

            <call name="sendPDUSessionResourceModifyResponse" >
            </call>
            
            <call name="PDUSessionModifyComplete" >
                <input>
                </input>
                <output>
                    <parameter name="[function:pdu_sess_mod_msg]" />
                </output>
            </call>
            
            <call name="encryptNasMessage" >
                <input>
                    <parameter name="[function:plainNasMessage]" value="[pdu_sess_mod_msg]"/>
                </input>
                <output>
                    <parameter name="[function:out_encrypt_ret]" />
                    <parameter name="[function:out_encrypt_msg]" />
                    <parameter name="[function:out_sqn]" />
                    <parameter name="[function:out_overflow]" />
                </output>
            </call>
            
            <parameter name="[uplinkCount_sqn]" operation="set" value="[out_sqn]"/>  
            <parameter name="[uplinkCount_overflow]" operation="set" value="[out_overflow]"/>  
            <parameter name="[send_nas_pdu_msg]" operation="set" value="[out_encrypt_msg]"/>  

            <call name="uplinkNas" >
                <input>
                    <parameter name="[function:nas_pdu_msg]"  value="[send_nas_pdu_msg]"/>
                </input>
            </call>    
            
            <parameter name="[out_ret]" operation="set" value="true"/>  
            <parameter name="[out_sqn]" operation="set" value="[out_sqn]"/>  
            <parameter name="[out_overflow]" operation="set" value="[out_overflow]"/>  
        </do>
      
        <output>              
            <parameter name="[function:out_ret]" />     
            <parameter name="[function:out_sqn]" />
            <parameter name="[function:out_overflow]" />
        </output>
    </function>
</scenario>
