<?xml version="1.0" encoding="UTF-8"?>
<!-- Related XMLSchema file: conf/schemas/scenario.xsd -->
<!--  name="Send 3GPP Cx/Dx User-Authorization request (UAR)" -->

<scenario>
    
    <!--parameter name="[localHosts]" operation="system.ipaddress" value2="[IPVersion]"/-->
    <sendMessageNGAP name="Send NGSetup" channel="channel_client">
        <NGAP-PDU>
            <initiatingMessage>
                <procedureCode>21</procedureCode>
                <criticality>reject</criticality>
                <value>
                    <NGSetupRequest>
                        <protocolIEs>
                            <protocolIEs>
                                <id>27</id>
                                <criticality>reject</criticality>
                                <value>
                                    <GlobalRANNodeID>
                                        <globalGNB-ID>
                                         <pLMNIdentity>[PLMN_ID]</pLMNIdentity>
                                         <gNB-ID><gNB-ID>[GNB_ID]</gNB-ID></gNB-ID>
                                     </globalGNB-ID>
                                    </GlobalRANNodeID>
                                </value>
                            </protocolIEs>
                            <protocolIEs>
                                <id>82</id>
                                <criticality>ignore</criticality>
                                <value>
                                    <RANNodeName>gnb.test.com</RANNodeName>
                                </value>
                            </protocolIEs>
                            <protocolIEs>
                                <id>21</id>
                                <criticality>ignore</criticality>
                                <value>
                                    <PagingDRX>v32
                                    </PagingDRX>
                                </value>
                            </protocolIEs>
                            <protocolIEs>
                                <id>102</id>
                                <criticality>ignore</criticality>
                                <value>
                                    <SupportedTAList>
                                        <SupportedTAList>
                                            <tAC>[TAC]</tAC>
                                            <broadcastPLMNList>
                                            <broadcastPLMNList>
                                                <pLMNIdentity>[PLMN_ID]</pLMNIdentity>
                                                <tAISliceSupportList>
                                                <tAISliceSupportList>
                                                    <s-NSSAI>
                                                        <sST>[SST]</sST>
                                                        <SD>[SD]</SD>
                                                    </s-NSSAI>
                                                </tAISliceSupportList>
                                                </tAISliceSupportList>
                                            </broadcastPLMNList>
                                            </broadcastPLMNList>
                                        </SupportedTAList>
                                    </SupportedTAList>
                                </value>
                            </protocolIEs>
                        </protocolIEs>
                    </NGSetupRequest>
                </value>
            </initiatingMessage>
        </NGAP-PDU>
    </sendMessageNGAP>

    <log type="Scenario" level="INFO"> waiting ngsetup response</log>
    <parameter name="[received]" operation="set" value="false"/>        
    <receiveMessageNGAP name="wait_ngsetupresp" channel="channel_client" timeout="[timeout]" failedOnTimeout="true">
        <parameter name="[messageType]" operation="protocol.setFromMessage" value="message.type"/>
        <parameter name="[received]" operation="set" value="true"/> 
    </receiveMessageNGAP>

    <if>
        <condition>
            <test parameter="[received]" condition="string.equals" value="false"/>                                              
        </condition>
        <then>
           <exit name="exit" failed="true"/>
        </then>     
    </if>

    <if>
        <condition>
            <test parameter="[messageType]" condition="string.equals" value="NGSetupResponse"/>
        </condition>
        <then>
            <log type="Scenario" level="INFO">Received NGSetupResponse</log>
        </then>    
        <else>
            <exit name="failed exit" failed="false"/>
        </else>
    </if>

    <log type="Scenario" level="INFO"> NG setup success!!!!!!</log>
</scenario>
